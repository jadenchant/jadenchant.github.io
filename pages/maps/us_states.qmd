---
title: "US States"
format: 
  bookup-html+darkonly:
    embed-fonts: true
editor_options: 
  chunk_output_type: console
---

```{r}
#| include: false

library(tidyverse)
library(mdsr)
library(maps)
library(viridis)
library(poliscidata)

# cancer_data <- read_csv("https://jadenchant.github.io/data/us_cancer_death.csv")
# 
# cancer_data <- cancer_data |>
#   mutate(state = gsub('.*,\\s*', '', County)) |>
#   mutate(state = str_squish(str_to_lower(as.character(state)))) |>
#   mutate(state = gsub(" ", "", state)) |>
#   mutate(state = gsub("districtofcolumbia[(]state[)]", "districtofcolumbia", state)) |>
#   mutate(state = gsub("<sup>3</sup>", "", state)) |>
#   mutate(avg_death = `Average Deaths per Year`) |>
#   filter(state != "unitedstates") |>
#   filter(!is.na(avg_death)) |>
#   mutate(avg_death = as.numeric(avg_death))
# 
# cancer <- cancer_data |>
#   group_by(state) |>
#   summarise(cancer_death = sum(avg_death))


state_data <- as_tibble(poliscidata::states) |>
  mutate(state_name = str_squish(str_to_lower(as.character(state)))) |>
  select(-state)

us_states <- map_data("state") |>
  mutate(region = str_squish(str_to_lower(as.character(region)))) |>
  mutate(region = gsub(" ", "", region))

 
# state_data |>
#   right_join(us_states, by = c("state_name" = "region")) |>
#   ggplot(mapping = aes(x = long, y = lat,
#                           group = group)) + 
#   geom_polygon(aes(fill = prolife), color = "black") + 
#   labs(fill = "Percent Pro-Life") +
#   coord_map() +
#   theme_void() +
#   scale_fill_viridis(option = "C")
```


```{r}
#| message: false
#| warning: false

poverty_data <- read_csv("https://jadenchant.github.io/data/poverty_estimates.csv")



```

POVALL_2021	Estimate of people of all ages in poverty 2021
CI90LBALL_2021	90 percent confidence interval lower bound of estimate of people of all ages in poverty 2021
CI90UBALL_2021	90 percent confidence interval upper bound of estimate of people of all ages in poverty 2021
PCTPOVALL_2021	Estimated percent of people of all ages in poverty 2021
CI90LBALLP_2021	90 percent confidence interval lower bound of estimate of percent of people of all ages in poverty 2021
CI90UBALLP_2021	90 percent confidence interval upper bound of estimate of percent of people of all ages in poverty 2021
POV017_2021	Estimate of people age 0-17 in poverty 2021
CI90LB017_2021	90 percent confidence interval lower bound of estimate of people age 0-17 in poverty 2021
CI90UB017_2021	90 percent confidence interval upper bound of estimate of people age 0-17 in poverty 2021
PCTPOV017_2021	Estimated percent of people age 0-17 in poverty 2021
CI90LB017P_2021	90 percent confidence interval lower bound of estimate of percent of people age 0-17 in poverty 2021
CI90UB017P_2021	90 percent confidence interval upper bound of estimate of percent of people age 0-17 in poverty 2021
POV517_2021	Estimate of related children age 5-17 in families in poverty 2021
CI90LB517_2021	90 percent confidence interval lower bound of estimate of related children age 5-17 in families in poverty 2021
CI90UB517_2021	90 percent confidence interval upper bound of estimate of related children age 5-17 in families in poverty 2021
PCTPOV517_2021	Estimated percent of related children age 5-17 in families in poverty 2021
CI90LB517P_2021	90 percent confidence interval lower bound of estimate of percent of related children age 5-17 in families in poverty 2021
CI90UB517P_2021	90 percent confidence interval upper bound of estimate of percent of related children age 5-17 in families in poverty 2021
MEDHHINC_2021	Estimate of median household income 2021
CI90LBINC_2021	90 percent confidence interval lower bound of estimate of median household income 2021
CI90UBINC_2021	90 percent confidence interval upper bound of estimate of median household income 2021
POV04_2021	Estimate of children ages 0 to 4 in poverty 2021 (available for the U.S. and State total only)
CI90LB04_2021	90 percent confidence interval lower bound of estimate of children ages 0 to 4 in poverty 2021 (available for the U.S. and State total only)
CI90UB04_2021	90 percent confidence interval upper bound of estimate of children ages 0 to 4 in poverty 2021 (available for the U.S. and State total only)
PCTPOV04_2021	Estimated percent of children ages 0 to 4 in poverty 2021 (available for the U.S. and State total only)
CI90LB04P_2021	90 percent confidence interval lower bound of estimate of percent of children ages 0 to 4 in poverty 2021 (available for the U.S. and State total only)
CI90UB04P_2021	90 percent confidence interval upper bound of estimate of percent of children ages 0 to 4 in poverty 2021 (available for the U.S. and State total only)



```{r}
#| message: false
#| warning: false

state_data |>
  right_join(us_states, by = c("state_name" = "region")) |>
  ggplot(mapping = aes(x = long, y = lat,
                          group = group)) + 
  geom_polygon(aes(fill = prolife), color = "black") + 
  labs(fill = "Percent Pro-Life") +
  coord_map() +
  theme_void() +
  scale_fill_viridis(option = "C")
```
